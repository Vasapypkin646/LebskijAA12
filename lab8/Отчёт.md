# **Отчет по лабораторной работе №8: Тестирование программного обеспечения системы учета сотрудников**

## Сведения о студенте  
**Дата:** [2025-12-22]  
**Семестр:** [2 курс, 1 семестр]  
**Группа:** [Пин-б-о-24-1]  
**Дисциплина:** [Технологии программирования]  
**Студент:** [Лебский Артём Александрович]  

---

## **1. ЦЕЛЬ РАБОТЫ**

Освоить основы модульного тестирования, научиться писать unit-тесты для классов и методов, использовать фреймворк `pytest`, применять техники изоляции зависимостей с помощью моков и стабов, а также тестировать применение паттернов проектирования в системе учета сотрудников.

## **2. ЗАДАЧИ РАБОТЫ**

1. Написать модульные тесты для класса `Employee` с проверкой инкапсуляции, валидации данных и работы методов
2. Протестировать иерархию классов сотрудников, включая наследование и абстрактные методы
3. Протестировать полиморфное поведение и магические методы в системе
4. Протестировать композицию, агрегацию и сложные бизнес-методы в системе компании
5. Протестировать реализацию паттернов проектирования (Singleton, Strategy, Adapter, Repository)

## **3. ТЕОРЕТИЧЕСКАЯ ЧАСТЬ**

### **3.1. Основные понятия тестирования**

- **Unit-тестирование** – тестирование отдельных модулей (функций, методов, классов) в изоляции
- **Фикстуры (Fixtures)** – предварительно настроенные данные или объекты для тестов
- **Mock-объекты** – объекты-заглушки, имитирующие поведение реальных объектов
- **Параметризованные тесты** – запуск одного теста с разными наборами данных
- **Покрытие кода (Code Coverage)** – метрика, показывающая процент кода, покрытого тестами

### **3.2. Используемые паттерны тестирования**

- **Arrange-Act-Assert (AAA)** – стандартная структура unit-теста
- **Test Doubles** – использование заглушек (mocks, stubs, spies)
- **Data-Driven Testing** – параметризация тестовых данных
- **Integration Testing** – тестирование взаимодействия компонентов

### **3.3. Инструменты тестирования**

- **pytest** – фреймворк для написания и запуска тестов
- **pytest-cov** – плагин для измерения покрытия кода
- **pytest-mock** – интеграция с библиотекой unittest.mock
- **pytest-xdist** – параллельный запуск тестов

## **4. ПРАКТИЧЕСКАЯ ЧАСТЬ**

### **4.1. Подготовка окружения**

#### **4.1.1. Установка зависимостей**
```bash
pip install -r requirements.txt
```


#### **4.1.2. Структура тестового проекта**
```
lab8/
├── test_employee.py # 25 тестов для базовых классов
├── test_employees_hierarchy.py # 18 тестов для иерархии классов
├── test_department.py # 22 теста для класса Department
├── test_project_company.py # 35 тестов для Project и Company
├── test_patterns.py # 25 тестов для паттернов проектирования
├── conftest.py # Общие фикстуры для pytest
├── Zadanie.py # Основная реализация системы
├── patterns/ # Реализация паттернов
│   ├── init.py
│   ├── singleton.py
│   ├── strategy.py
│   ├── adapter.py
│   └── repository.py
└── requirements.txt # Зависимости для тестирования
```


### **4.2. Реализованные тесты**

#### **4.2.1. Тестирование базового класса Employee** (`test_employee.py`)
- Тестирование конструктора и свойств
- Тестирование валидации данных (ID, зарплата, имя)
- Тестирование методов расчета зарплаты
- Тестирование строкового представления
- Тестирование операторов сравнения и сложения
- Тестирование сериализации/десериализации

**Ключевые тесты:**
- Проверка создания сотрудника с валидными данными
- Проверка исключений при некорректных данных
- Параметризованные тесты валидации зарплаты
- Тестирование полиморфного поведения через AbstractEmployee

#### **4.2.2. Тестирование иерархии классов** (`test_employees_hierarchy.py`)
- Тестирование классов Manager, Developer, Salesperson
- Параметризованные тесты расчета зарплат по уровням
- Тестирование методов добавления навыков (Developer)
- Тестирование обновления продаж (Salesperson)
- Тестирование фабрики сотрудников
- Тестирование полиморфного поведения коллекций

**Ключевые тесты:**
- Расчет зарплаты менеджера с бонусом
- Расчет зарплаты разработчика по уровню (junior/middle/senior)
- Расчет зарплаты продавца с комиссией
- Работа фабрики для создания разных типов сотрудников

#### **4.2.3. Тестирование класса Department** (`test_department.py`)
- Тестирование управления сотрудниками (добавление/удаление)
- Тестирование расчета общей зарплаты отдела
- Тестирование статистики по типам сотрудников
- Тестирование магических методов (__len__, __getitem__, __contains__)
- Тестирование сериализации/десериализации в JSON
- Тестирование итерации по отделу

**Ключевые тесты:**
- Обработка дублирующихся ID сотрудников
- Поиск сотрудника по ID
- Сериализация в файл и восстановление из файла
- Тестирование методов has_employees и сортировки

#### **4.2.4. Тестирование Project и Company** (`test_project_company.py`)
- Тестирование валидации данных проекта (дата, статус)
- Тестирование управления командой проекта
- Тестирование изменения статусов проекта
- Тестирование управления отделами и проектами компании
- Тестирование поиска сотрудников в компании
- Тестирование бизнес-методов (статистика, анализ, отчеты)
- Тестирование сериализации всей компании

**Ключевые тесты:**
- Валидация дат и статусов проекта
- Обработка ошибок при удалении отделов с сотрудниками
- Расчет общих затрат компании
- Поиск перегруженных сотрудников
- Генерация финансовых отчетов
- Экспорт данных в CSV/JSON

#### **4.2.5. Тестирование паттернов проектирования** (`test_patterns.py`)
- Тестирование паттерна Singleton (единый экземпляр DatabaseConnection)
- Тестирование паттерна Strategy (различные стратегии расчета бонусов)
- Тестирование паттерна Adapter (адаптация внешней системы расчета зарплат)
- Тестирование паттерна Repository (работа с базой данных)
- Интеграционные тесты взаимодействия паттернов
- Тестирование с использованием mock-объектов

**Ключевые тесты:**
- Проверка единственности экземпляра Singleton
- Динамическая смена стратегий расчета бонусов
- Расчет зарплат через внешнюю систему (Adapter)
- CRUD-операции через Repository
- Взаимодействие нескольких паттернов в одном сценарии

### **4.3. Общие фикстуры и конфигурация**

**Файл:** `conftest.py`
- Фикстуры для создания тестовых объектов (сотрудники, отделы, проекты)
- Автоматическая очистка статических коллекций между тестами
- Фикстура для очистки ID (предотвращение конфликтов)
- Поддержка изоляции тестов

## **5. РЕЗУЛЬТАТЫ ТЕСТИРОВАНИЯ**

### **5.1. Статистика тестов**

Всего тестов: 125 

По файлам:
- test_employee.py: 25 тестов
- test_employees_hierarchy.py: 18 тестов
- test_department.py: 22 теста
- test_project_company.py: 35 тестов
- test_patterns.py: 25 тестов


### **5.2. Запуск тестов**
```bash
# Запуск всех тестов
pytest -v

# Запуск тестов с покрытием кода
pytest --cov=. --cov-report=html

# Запуск тестов в параллельном режиме
pytest -n auto

# Запуск конкретного файла тестов
pytest test_employee.py -v

# Запуск тестов с генерацией отчета
pytest --html=report.html --self-contained-html
```

### **5.3. Результаты покрытия кода**

```
Название                           Стволов    Пропущ    Покрытие
----------------------------------------------------------------
Zadanie.py                           425       105       75.29%
patterns/singleton.py                 25         0      100.00%
patterns/strategy.py                  30         0      100.00%
patterns/adapter.py                   25         0      100.00%
patterns/repository.py                80        15       81.25%
----------------------------------------------------------------
ВСЕГО                                585       120       79.49%
```

### **5.4. Ключевые метрики качества**
1. Покрытие тестами: 79.49% 
2. Успешность тестов: 100% 
3. Время выполнения: ~3.5 секунды 
4. Параметризованные тесты: 15 тестов с разными наборами данных
5. Интеграционные тесты: 8 комплексных сценариев

## 6. АНАЛИЗ РЕЗУЛЬТАТОВ

### 6.1. Эффективность тестирования
Полное покрытие критической бизнес-логики: расчет зарплат, валидация, управление сотрудниками

Тестирование граничных случаев: отрицательные зарплаты, пустые имена, дублирующиеся ID

Интеграционное тестирование: взаимодействие всех компонентов системы

Тестирование производительности: быстрые unit-тесты (менее 100ms каждый)

### 6.2. Обнаруженные проблемы и их решение

**Проблема 1**: Конфликты ID между тестами из-за статических коллекций  
Решение: Добавление фикстуры reset_static_collections в `conftest.py `

**Проблема 2**: Зависимость тестов от внешних файлов    
Решение: Использование временных файлов через `tmp_path` фикстуру pytest    

**Проблема 3**: Сложность тестирования приватных методов    
Решение: Рефакторинг с акцентом на публичное API и использование property   

**Проблема 4**: Дублирование кода в тестах  
Решение: Вынесение общих операций в фикстуры и вспомогательные функции  

## 7. ПРИМЕРЫ РАБОТЫ ТЕСТОВ

### 7.1. Пример параметризованного теста
```python
@pytest.mark.parametrize("level,expected_salary", [
    ("junior", 5000),
    ("middle", 7500),
    ("senior", 10000)
])
def test_developer_salary_by_level(self, level, expected_salary):
    # Один тест проверяет три разных сценария
    dev = Developer(301, "Bob", "DEV", 5000, ["Python"], level, skip_validation=True)
    assert dev.calculate_salary() == expected_salary
```

### 7.2. Пример теста с фикстурами
```python
def test_department_statistics(self, sample_department):
    # Использование готового отдела из фикстуры
    counts = sample_department.get_employee_count()
    assert counts["Employee"] == 1
    assert counts["Manager"] == 1
    assert counts["Developer"] == 1
```

### 7.3. Пример интеграционного теста
```python
def test_complex_company_integration(self):
    # Тестирование взаимодействия всех компонентов
    company = Company("TechInnovations")
    # ... создание отделов, сотрудников, проектов
    # ... проверка бизнес-логики
    assert company.calculate_total_monthly_cost() > 0
    assert len(company.get_all_employees()) == 3
```

### 7.4. Пример теста с mock-объектами
```python
def test_patterns_with_mocks(self):
    # Тестирование без реальных зависимостей
    mock_strategy = Mock()
    mock_strategy.calculate_bonus.return_value = 1000.0
    
    context = BonusContext(mock_strategy)
    bonus = context.calculate_bonus(employee)
    
    assert bonus == 1000.0
    mock_strategy.calculate_bonus.assert_called_once_with(employee)
```


## 8. ВЫВОДЫ

Реализована комплексная система тестирования для системы учета сотрудников, включающая unit-тесты, интеграционные тесты и тестирование паттернов проектирования. Все поставленные задачи выполнены, тесты демонстрируют высокое качество кода и корректность реализации системы. Полученные навыки тестирования могут быть применены в реальных проектах для обеспечения качества программного обеспечения.
Выполненная работа представляет собой полноценную систему тестирования, соответствующую профессиональным стандартам качества. Разработанные тесты не только проверяют корректность реализации, но и служат документацией к системе, демонстрируют лучшие практики тестирования и могут быть использованы как образец для подобных проектов.